from Crypto.Util.number import long_to_bytes
from py_ecc import bn128 as lib

p = lib.field_modulus

G1m = (
    lib.FQ(int(11469372800210105260727590463073506208044033830870930872330243851097831737764)),
    lib.FQ(int(1824583255701861010485373665759047621142115137095486777308222809009032384627))
)

G2m = (
    lib.FQ2([int(15370031806930629878263531909994337963970190011267915371085946350334444778727), int(10459200952120625632845406741460650882569665318932155887689219394120633717306)]),
    lib.FQ2([int(19638478083949593397772590686912779106853349285972720902007677911656276830119), int(9188400026649655679400691293973957726382241893634841873506254435507467101618)])
)

GF12 = GF(p**12, 'a', modulus=x^12-18*x^6+82)

pairing_g2m_g1m = GF12(
    eval(
        str(
            lib.pairing(G2m, G1m)
        )
    )
)

enc = GF12([
    3864929051102964770294276756692804239273448849099873077394178852707497643064,
    20592459928545191826931733511921601179763970567698700096883470199408432588353,
    14442249209778136460885125312318990997910124067725787191437742365669498874562,
    5379331772763743582759658896570540478579923692938865713050731429295324015283,
    9047824236807357977834487183478054588495363731447792566152885925688807697374,
    34426869692554077096277926338015839954618310968397888352589770015282878693,
    8805869281673333712522898617550637565846997079269810461911590752040993073633,
    5782763734139893395489033971251211762200693413700891931436104371864195853535,
    8034994451277825755315947148205896912060328517665483634343944698727982987334,
    21043663421638881664339906853012673403697552558755562449230033956422997523611,
    14322089096610513344946366113573287017575931462609011527179215866515759695992,
    10615233709179433701441100887450799474654038525314314862623533557423396782383
][::-1])

flag = enc * (pairing_g2m_g1m^-127)

print(long_to_bytes(int(flag)))